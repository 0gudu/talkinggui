<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>talking gui</title>
    <!-- Adicione a ligação ao Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <style>
        body {
            height: 100vh; /* 100% da altura da tela */
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="assets/png/guisentado.png" id="guiverme" alt="Personagem Sentado" width="70%" class="mx-auto d-block">
        <img src="assets/png/ligar.png" onclick="ligar()" id="botao" width="20%" class="mx-auto d-block">
    </div>

    <!-- Adicione a ligação ao Bootstrap JS e ao jQuery (opcional, necessário para alguns recursos do Bootstrap) -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <audio id="audioPlayer" src="assets/mp3/tocando.mp3"></audio>
    <audio id="SIM" src="assets/mp3/SIM.mp3"></audio>
    <audio id="NAO" src="assets/mp3/NAO.mp3"></audio>
    <audio id="TALVEZ" src="assets/mp3/TALVEZ.mp3"></audio>
    <audio id="XINGAO" src="assets/mp3/VAI SE FERRA.mp3"></audio>
    <audio id="DESLIGAR" src="assets/mp3/DESLIGAR.mp3"></audio>
</body>
<script src="jquery.js"></script>
<script>

    var audioElement = $("#audioPlayer")[0];

    var sim = $("#SIM")[0];
    var nao = $("#NAO")[0];
    var talvez = $("#TALVEZ")[0];
    var xingao = $("#XINGAO")[0];
    var desligar = $("#DESLIGAR")[0];

    var andamento = 0;
    let recognition;
    function ligar() {
        if (andamento == 0){
            audioElement.play();
            setTimeout(() => {
                ligui(1);
            }, 2000);
                ligui(3);
            
        }else {
            ligui(0);
        }
    }

    function ligui(x){
        if (x == 1) {
            $("#guiverme").attr("src", "assets/png/guicomsaco.png");
            $("#botao").attr("src", "assets/png/desligar.png");
            andamento = 1;
            if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
                    recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

                    recognition.onstart = function() {
                        console.log('Iniciou a detecção de fala.');
                    };

                    recognition.onresult = function(event) {
                        const transcript = event.results[0][0].transcript;
                        console.log('Texto reconhecido:', transcript);
                        // Aqui você pode chamar a função desejada quando a fala é detectada
                    };

                    recognition.onend = function() {
                        console.log('Parou a detecção de fala.');
                        const escolha = Math.floor(Math.random() * 5) + 1;
                        switch(escolha){
                            case 1:
                                console.log(escolha);
                                sim.play();
                                setTimeout(() => {
                                    ligui(0);
                                }, 1000);
                            break;
                            case 2:
                                console.log(escolha);
                                nao.play();
                                setTimeout(() => {
                                    ligui(0);
                                }, 1000);
                            break;
                            case 3:
                                console.log(escolha);
                                talvez.play();
                                setTimeout(() => {
                                    ligui(0);
                                }, 1000);
                            break;
                            case 4:
                                console.log(escolha);
                                xingao.play();
                                setTimeout(() => {
                                    ligui(0);
                                }, 1000);
                            break;
                            case 5:
                                console.log(escolha);
                                    ligui(0);
                            break;
                        }
                        
                        
                        $('#stopButton').prop('disabled', true);
                        $('#startButton').prop('disabled', false);
                    };

                    recognition.start();
                    $('#startButton').prop('disabled', true);
                    $('#stopButton').prop('disabled', false);
                } else {
                    alert('não é suportado neste navegador.');

                }
            
        } else if (x == 0){
            $("#guiverme").attr("src", "assets/png/guisentado.png");
            $("#botao").attr("src", "assets/png/ligar.png");
            desligar.play();
            andamento = 0;
        }else if (x == 3){
            audioElement.play();
        }
    }
            $('#stopButton').on('click', function() {
                if (recognition) {
                    recognition.stop();
                }
            });

</script>
</html>
